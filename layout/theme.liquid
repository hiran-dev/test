<!doctype html>
{% capture rtl_codes %},ar,arc,ckb,dv,fa,ha,he,khw,ks,ps,sd,ur,uz_AF,yi,{% endcapture %}
{% assign is_code_separator = request.locale.iso_code | append: ',' | prepend: ',' %}
{% assign is_rtl =  nil %}
{% if rtl_codes contains is_code_separator %}
  {% assign is_rtl =  true %}
{% endif %}
<html class="no-js" lang="{{ request.locale.iso_code }}" {% if is_rtl %} dir="rtl"{% endif %}>

{%- assign title_override = false -%}
{%- assign default_description = false -%}
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="theme-color" content="{{ settings.color_secondary }}">
  {%- if canonical_url != blank -%}
    <link rel="canonical" href="{{ canonical_url }}">
  {%- endif -%}

  <!-- ======================= Pipeline Theme V8.1.1 ========================= -->

  <!-- Preloading ================================================================== -->

  <link rel="preconnect" href="https://fonts.shopify.com" crossorigin>
  {%- assign font_body_family = settings.font_body_family | font_url -%}
  {%- assign font_heading_family = settings.font_heading_family | font_url -%}
  {%- assign font_accent_family = settings.font_accent_family | font_url -%}
  {%- if font_body_family != blank -%}
      <link rel="preload" href="{{ font_body_family }}" as="font" type="font/woff2" crossorigin>
  {%- endif -%}
  {%- if font_heading_family != blank -%}
    <link rel="preload" href="{{ font_heading_family }}" as="font" type="font/woff2" crossorigin>
  {%- endif -%}
  {%- if font_accent_family != blank -%}
      <link rel="preload" href="{{ font_accent_family }}" as="font" type="font/woff2" crossorigin>
  {%- endif -%}

  <!-- Title and description ================================================ -->
  {%- if settings.favicon != blank -%}
    <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
  {%- else -%}
    <link rel="shortcut icon" href="data:;base64,iVBORw0KGgo=">
  {%- endif -%}

  {% capture seo_title %}
    {%- assign title_content = page_title -%}
    {% if title_override %}
      {%- assign title_content = title_override -%}
    {% endif %}
    {{ title_content }}
    {%- if current_tags -%}
      {%- assign meta_tags = current_tags | join: ', ' -%} &ndash; {{ 'general.meta.tags' | t: tags: meta_tags }}
    {%- endif -%}
    {%- if current_page != 1 -%}
      &ndash; {{ 'general.meta.page' | t: page: current_page }}
    {%- endif -%}
    {%- assign title_downcase = title_content | downcase | strip -%}
    {%- assign name_downcase = shop.name | downcase | strip -%}
    {%- unless title_downcase contains name_downcase -%}
      &ndash; {{ shop.name }}
    {%- endunless -%}
  {% endcapture %}
  <title>
    {{ seo_title }}
  </title>

  {%- if page_description -%}
    <meta name="description" content="{{ page_description | escape }}">
  {% elsif default_description %}
    <meta name="description" content="{{ default_description | escape }}">
  {%- endif -%}

  {%- render 'social-meta-tags' -%}

  <!-- CSS ================================================================== -->

  {{ 'font-settings.css' | asset_url | stylesheet_tag: preload: true }}

  {% render 'css-variables' %}

  {{ 'theme.css' | asset_url | stylesheet_tag: preload: true }}

  <script>
    document.documentElement.className = document.documentElement.className.replace('no-js', 'js');

    {% if settings.animations_scroll_enable %}
      document.documentElement.classList.add('aos-initialized');
    {%- endif -%}

    let root = '{{ routes.root_url }}';
    if (root[root.length - 1] !== '/') {
      root = `${root}/`;
    }
    var theme = {
      routes: {
        root_url: root,
        cart: '{{ routes.cart_url }}',
        cart_add_url: '{{ routes.cart_add_url }}',
        product_recommendations_url: '{{ routes.product_recommendations_url }}',
        account_addresses_url: '{{ routes.account_addresses_url }}',
        predictive_search_url: '{{ routes.predictive_search_url }}'
      },
      state: {
        cartOpen: null,
      },
      sizes: {
        small: 480,
        medium: 768,
        large: 1100,
        widescreen: 1400
      },
      assets: {
        photoswipe: '{{ "photoswipe.js" | asset_url }}',
        smoothscroll: '{{ "smoothscroll.js" | asset_url }}',
        swatches: '{{ "swatches.json" | asset_url }}',
        noImage: '{{ "nil" | img_url: "master" }}',
        {% comment %} Used to get the base path for images {% endcomment %}
        {% # theme-check-disable MissingAsset %}
        base: '{{ "nil.jpg" | asset_url | split: "nil.jpg" | first }}'
        {% # theme-check-enable MissingAsset %}
      },
      strings: {
        swatchesKey: {{ 'general.swatches.color' | t | json }},
        addToCart: {{ 'products.product.add_to_cart' | t | json }},
        estimateShipping: {{ 'cart.shipping.estimate_shipping' | t | json }},
        noShippingAvailable: {{ 'cart.shipping.no_shipping_available' | t | json }},
        free: {{ 'cart.shipping.free' | t | json }},
        from: {{ 'products.general.from' | t | json }},
        preOrder: {{ 'products.product.pre_order' | t | json }},
        soldOut: {{ 'products.product.sold_out' | t | json }},
        sale: {{ 'products.product.sale' | t | json }},
        subscription: {{ 'products.product.subscription' | t | json }},
        unavailable: {{ 'products.product.unavailable' | t | json }},
        unitPrice: {{ 'products.product.unit_price_label' | t | json }},
        unitPriceSeparator: {{ 'general.accessibility.unit_price_separator' | t | json }},
        stockout: {{ 'cart.general.stockout' | t | json }},
        products: {{ 'products.general.products' | t | json }},
        pages: {{ 'general.page.pages' | t | json }},
        collections: {{ 'collections.sidebar.collections' | t | json }},
        resultsFor: {{ 'general.search.results_for' | t | json }},
        noResultsFor: {{ 'general.search.no_results_for' | t | json }},
        articles: {{ 'blogs.article.articles' | t | json }},
        successMessage: {{ 'general.share.success_message' | t | json }},
      },
      settings: {
        badge_sale_type: {{ settings.badge_sale_type | json }},
        animate_hover: {{ settings.animations_hover_enable | json }},
        animate_scroll: {{ settings.animations_scroll_enable | json }},
        show_locale_desktop: {{ settings.show_locale_desktop | json }},
        show_locale_mobile: {{ settings.show_locale_mobile | json }},
        show_currency_desktop: {{ settings.show_currency_desktop | json }},
        show_currency_mobile: {{ settings.show_currency_mobile | json }},
        currency_select_type: {{ settings.currency_select_type | json }},
        currency_code_enable: {{ settings.currency_code_enable | json }},
        cycle_images_hover_delay: {{ settings.cycle_images_hover_delay }}
      },
      info: {
        name: 'pipeline'
      },
      version: '8.1.1',
      moneyFormat: {{ shop.money_format | json }},
      shopCurrency: {{ shop.currency | json }},
      currencyCode: {{ cart.currency.iso_code | json }}
    }
    let windowInnerHeight = window.innerHeight;
    document.documentElement.style.setProperty('--full-screen', `${windowInnerHeight}px`);
    document.documentElement.style.setProperty('--three-quarters', `${windowInnerHeight * 0.75}px`);
    document.documentElement.style.setProperty('--two-thirds', `${windowInnerHeight * 0.66}px`);
    document.documentElement.style.setProperty('--one-half', `${windowInnerHeight * 0.5}px`);
    document.documentElement.style.setProperty('--one-third', `${windowInnerHeight * 0.33}px`);
    document.documentElement.style.setProperty('--one-fifth', `${windowInnerHeight * 0.2}px`);

    window.isRTL = document.documentElement.getAttribute('dir') === 'rtl';
  </script>

  {%- if request.page_type contains 'customers/' -%}
    <script src="{{ 'shopify_common.js' | shopify_asset_url }}" defer="defer"></script>
  {%- endif -%}

  <!-- Theme Javascript ============================================================== -->
  <script src="{{ 'vendor.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'theme.js' | asset_url }}" defer="defer"></script>

  {% comment %} Critical JS {% endcomment %}
  <script>
    function addLoadingClassToLoadingImages(container) {
      container.querySelectorAll('[data-needs-loading-animation] img').forEach((el) => {
        if (!el.complete) {
          el.parentNode.classList.add('loading-shimmer');
        }
      });
    }

    // Remove loading class from all already loaded images
    function removeLoadingClassFromLoadedImages(container) {
      container.querySelectorAll('img').forEach((el) => {
        if (el.complete) {
          delete el.parentNode.dataset.needsLoadingAnimation;
          el.parentNode.classList.remove('loading-shimmer');
        }
      });
    }

    // Remove loading class from image on `load` event
    function handleImageLoaded(el) {
      if (el.tagName == 'IMG' && el.parentNode.classList.contains('loading-shimmer')) {
        delete el.parentNode.dataset.needsLoadingAnimation;
        el.parentNode.classList.remove('loading-shimmer');
      }
    }

    // Watch for any load events that bubble up from child elements
    document.addEventListener(
      'load',
      (e) => {
        const el = e.target;

        // Capture load events from img tags and then remove their `loading-shimmer` class
        handleImageLoaded(el);
      },
      true
    );

    // Tasks to run when the DOM elements are available
    window.addEventListener('DOMContentLoaded', () => {
      addLoadingClassToLoadingImages(document);
    });
  </script>

  <script>
    (function () {
      function onPageShowEvents() {
        if ('requestIdleCallback' in window) {
          requestIdleCallback(initCartEvent, { timeout: 500 })
        } else {
          initCartEvent()
        }
        function initCartEvent(){
          window.fetch(window.theme.routes.cart + '.js')
          .then((response) => {
            if(!response.ok){
              throw {status: response.statusText};
            }
            return response.json();
          })
          .then((response) => {
            document.dispatchEvent(new CustomEvent('theme:cart:change', {
              detail: {
                cart: response,
              },
              bubbles: true,
            }));
            return response;
          })
          .catch((e) => {
            console.error(e);
          });
        }
      };
      window.onpageshow = onPageShowEvents;
    })();
  </script>

  <script type="text/javascript">
    if (window.MSInputMethodContext && document.documentMode) {
      var scripts = document.getElementsByTagName('script')[0];
      var polyfill = document.createElement("script");
      polyfill.defer = true;
      polyfill.src = "{{ 'ie11.js' | asset_url }}";

      scripts.parentNode.insertBefore(polyfill, scripts);
    }
  </script>

  <!-- Shopify app scripts =========================================================== -->
  {{ content_for_header }}

  {% render 'headfiles' %}
</head>


<body id="{{ page_title | handle }}" class="template-{{ template | replace: '.', ' ' | truncatewords: 1, '' | handle }} {{ settings.default_background }}{% if customer %} customer-logged-in{% endif %}">

  <a class="in-page-link visually-hidden skip-link" href="#MainContent">{{ 'general.accessibility.skip_to_content' | t }}</a>

  {% sections 'group-header' %}
  {% sections 'group-overlay' %}

  <main class="main-content" id="MainContent">
    {{ content_for_layout }}
  </main>

  {% sections 'group-footer' %}

  <div class="search--popdown">
    {% render 'search-predictive', version: 'search-popdown' %}
  </div>

  <div data-modal-container></div>

  {%- comment -%}
    In order to use your custom javascript file at assets/custom.js
    just cut and paste this next line outside this comment.
    <script src="{{ 'custom.js' | asset_url }}" defer="defer"></script>
  {%- endcomment -%}

  <!-- Paste popup code or third party scripts below this comment line ============== -->


  <!-- And above this comment line ================================================== -->
 {% render 'footfiles' %}
 
 {% comment %} to hide quantity, get it sticted and size guide in case of out od stock
  <script>
  // Function to hide elements when Sold Out / Notify Me is active
  const handleSoldOutState = () => {
    // Check for the Notify Me button (ID used by your app)
    const bisButton = document.getElementById('BIS_trigger');
    
    // Select the three sections you want to hide
    const qtyBox = document.querySelector('.product__block__quantity');
    const stitchingApp = document.querySelector('.tpo_radio-button-wrapper');
    const sizeGuide = document.querySelector('.best-fit-size-chart');

    if (bisButton) {
      // If Notify Me button exists, hide the others
      if (qtyBox) qtyBox.style.setProperty('display', 'none', 'important');
      if (stitchingApp) stitchingApp.style.setProperty('display', 'none', 'important');
      if (sizeGuide) sizeGuide.style.setProperty('display', 'none', 'important');
    } else {
      // If Add to Cart is back, show them again
      if (qtyBox) qtyBox.style.display = '';
      if (stitchingApp) stitchingApp.style.display = '';
      if (sizeGuide) sizeGuide.style.display = '';
    }
  };

  // 1. Run on page load
  window.addEventListener('load', handleSoldOutState);

  // 2. Run whenever the page changes (for variant switching)
  const productObserver = new MutationObserver((mutations) => {
    handleSoldOutState();
  });

  productObserver.observe(document.body, { 
    childList: true, 
    subtree: true 
  });
</script>

<style>
  /* Extra CSS backup to ensure the elements stay hidden */
  body:has(#BIS_trigger) .product__block__quantity,
  body:has(#BIS_trigger) .tpo_radio-button-wrapper,
  body:has(#BIS_trigger) .best-fit-size-chart {
    display: none !important;
  }
</style>
</body>
</html> {% endcomment %}

{% comment %} Optimized: Only hides blocks if UNSTITCHED is selected OR if the whole product is dead {% endcomment %}
<script>
  const handleProductUI = () => {
    // 1. Check if the "Notify Me" button is currently visible
    const bisButton = document.getElementById('BIS_trigger');
    const isNotifyMeVisible = bisButton && bisButton.offsetParent !== null;

    // 2. Select your sections
    const qtyBox = document.querySelector('.product__block__quantity');
    const stitchingApp = document.querySelector('.tpo_radio-button-wrapper');
    const sizeGuide = document.querySelector('.best-fit-size-chart');
    const sizeGuideAlt = document.querySelector('.scr-open-size-chart');

    // LOGIC: Only hide if the "Notify Me" button is active
    if (isNotifyMeVisible) {
      if (qtyBox) qtyBox.style.setProperty('display', 'none', 'important');
      if (stitchingApp) stitchingApp.style.setProperty('display', 'none', 'important');
      if (sizeGuide) sizeGuide.style.setProperty('display', 'none', 'important');
      if (sizeGuideAlt) sizeGuideAlt.style.setProperty('display', 'none', 'important');
    } else {
      // Show them back for available sizes (Ready to Wear)
      if (qtyBox) qtyBox.style.setProperty('display', 'block', 'important');
      if (stitchingApp) stitchingApp.style.setProperty('display', 'block', 'important');
      if (sizeGuide) sizeGuide.style.setProperty('display', 'block', 'important');
      if (sizeGuideAlt) sizeGuideAlt.style.setProperty('display', 'block', 'important');
    }
  };

  // Run on load and whenever variants change
  window.addEventListener('load', handleProductUI);
  const observer = new MutationObserver(() => handleProductUI());
  observer.observe(document.body, { childList: true, subtree: true });
</script>
